/* 
Maternity Services Dataset (MSDS) v1.5 MySQL set up

MySQL code to import raw data files as received from NHS England

The data covers version 1.5 of the MSDS for four financial years 2015/16 to 2018/19

The data are received as flat tab delimited files (as some fields contain multiple pipe delimited dates)
Plus a baby_record_id to token person ID bridge file. 
*/


CREATE TABLE rekggth_hes_ons.MSDS_BF (
record_id varchar(7),
tokenid varchar(15)
)
;

LOAD DATA LOCAL INFILE '~path/NIC393510_MSDS_BF.txt'
INTO TABLE rekggth_hes_ons.MSDS_BF
fields terminated by "|"
optionally enclosed by '"'
lines terminated by "\n"
ignore 1 lines
(@record_id, @tokenid)
SET
record_id = nullif(@record_id,''),
tokenid = nullif(@tokenid,'')
;

CREATE INDEX recid on rekggth_hes_ons.MSDS_BF (record_id);

CREATE TABLE rekggth_hes_ons.MSDS_1516 (
record_id_mother			varchar(7),
record_id_baby			varchar(7),
abnormalitydatingultrasound			varchar(3),
ageatbirthmother			smallint,
ageatbookingmother			smallint,
ageatdeathbaby			smallint,
ageatdeathmother			smallint,
alcoholunitsperweek			smallint,
antenatalappactivitydate			varchar(219),
antenatalbookingappdate			varchar(10),
antepathlevel			smallint,
apgarscore5			smallint,
babybreastmilkstatusdischarge			varchar(2),
babycomplicationatbirth			varchar(11),
babyfirstfeed			smallint,
babyfirstfeedbreastmilkstatus			varchar(2),
birthordermaternitysus			varchar(2),
birthweight			smallint,
caesareandatetime			datetime,
careplandate			varchar(54),
careplantype			varchar(14),
ccg_resmother			varchar(3),
cigarettesperday			smallint,
complexsocialfactorsind			varchar(1),
complicatingdiagtypemother			varchar(31),
countymother			varchar(9),
dayofbirthbaby			tinyint,
dayofdeathbaby			tinyint, 
dayssincedeliveryatdeathmother			smallint,
deathindicatormother			tinyint,
decisiontodeliverdatetime			datetime,
deliverymethodbaby			smallint,
deliveryplacechangereasoncode			varchar(9),
dischargedatetimemotherdeliveryh			datetime,
eddagreed			date,
eddlastmenstrualperiod			date,
eddmethodagreed			varchar(2),
electoralwardmother			varchar(9),
employmentstatusmother			varchar(2),
employmentstatuspartner			varchar(2),
eopsmokingstatus			varchar(7),
episiotomyreason			varchar(2),
fetalorderultrasoundanomaly			varchar(3),
firstlanguageenglishindmother			varchar(1),
folicacidsupplement			varchar(2),
genitaltracttraumaticlesion			varchar(14),
gestagefirstcontact			smallint,
gestageformalantenatalbooking			smallint,
gestationdatingultrasound			varchar(7),
gestationlengthbirth			smallint,
hpsantenataldischargedate			varchar(87),
hpsantenatalstartdate			varchar(87),
investigationresultultrasoundfet			varchar(5),
labouranaesthesiatype			varchar(11),
labourinductionmethod			varchar(5),
labouronsetdatetime			datetime,
labouronsetpresentation			varchar(2),
labourpainreliefmethod			varchar(20),
lad_uamother			varchar(9),
lastmenstrualperioddate			date,
leadanteprovider			varchar(3),
leadpostprov			varchar(5),
leadprofessionaltype			varchar(19),
lengthtimefirststagelabour			smallint,
lsoamother2011			varchar(9),
maternitydischargedate			varchar(43),
maternityfamilyhistorydiagtypeat			varchar(31),
mcidatetime			varchar(21),
mcitype			varchar(5),
merofbirthbaby			varchar(2),
mhpredictiondetectionindmother			varchar(1),
monthofbirthbaby			smallint,
neonatalcriticalincidentdate			varchar(54),
neonatalcriticalincidenttype			varchar(14),
neonataldiag			varchar(5),
neonataldiagdate			varchar(21),
neonatalresuscitationmethod			varchar(11),
neonataltransferstartdatetime			varchar(32),
newbornphysicalexamresulteyes			varchar(2),
newbornphysicalexamresultheart			varchar(2),
newbornphysicalexamresulthips			varchar(2),
newbornphysicalexamresulttestes			varchar(2),
newbornphysicalscreeningdate			date,
nhsnumberstatusmother			varchar(2),
nofetusesdatingultrasound			varchar(3),
orgcodeccg_gpp			varchar(3),
orgcodecommissioner			varchar(5),
orgcodegmpmother			varchar(6),
orgcodepostnatalpathleadprovider			varchar(5),
orgcodeprovider			varchar(3),
oxytocinadministereddatetime			varchar(21),
persondeathdatetimebaby			datetime,
persondeathdatetimemother			datetime,
personheight			float(6),
personphenotypicsex			varchar(1),
personweight			float(6),
physicaldisabilitystatusindmothe			varchar(1),
placentadeliverymethod			varchar(2),
placetypeactualdelivery			varchar(1),
placetypeactualmidwifery			varchar(1),
placetypeintendeddelivery			varchar(9),
placetypeintendedmidwifery			varchar(9),
postcodedistrictmother			varchar(4),
postpartumhspdischargedatetime			varchar(43),
postpartumhspstartdatetime			varchar(43),
postpathlevel			varchar(19),
pregnancyfirstcontactcareprofess			varchar(19),
pregnancyfirstcontactdate			varchar(43),
pregnancymedicaldiagdate			varchar(43),
pregnancymedicaldiagtype			varchar(14),
pregnancyobstetricdiagdate			varchar(54),
pregnancyobstetricdiagtype			varchar(14),
pregnancyoutcomemonth			smallint,
pregnancyoutcomeyear			smallint,
previouscaesareansections			smallint,
previouscomplicatingdiagtypemoth			varchar(19),
previouslivebirths			smallint,
previouslosseslessthan24weeks			smallint,
previousstillbirths			smallint,
proceduredatedatingultrasound			varchar(21),
proceduredatetimefetalanomaly			varchar(21),
rank_imd_decile_2015			varchar(19),
romdatetime			datetime,
rommethod			varchar(2),
romreason			varchar(2),
sitecodeactualdelivery			varchar(6),
sitecodeadmittingneonatal			varchar(17),
sitecodeintendeddelivery			varchar(29),
skintoskincontact1hour			varchar(1),
smokingstatus			varchar(2),
startdatetimemotherdeliveryhps			datetime,
substanceusestatus			varchar(2),
supportstatusmother			varchar(1),
validnhsnoflag			varchar(1),
validpostcodeflag			varchar(1),
waterdeliveryind			varchar(1),
yearofbirthbaby			smallint
)
;

LOAD DATA LOCAL INFILE '~path/NIC393510_MSDS_1516_R.txt'
INTO TABLE rekggth_hes_ons.MSDS_1516
fields terminated by "\t"
lines terminated by "\n"
ignore 1 lines
(@record_id_mother, @record_id_baby, @abnormalitydatingultrasound, @ageatbirthmother, @ageatbookingmother, @ageatdeathbaby, @ageatdeathmother, @alcoholunitsperweek, 
@antenatalappactivitydate, @antenatalbookingappdate, @antepathlevel, @apgarscore5, @babybreastmilkstatusdischarge, @babycomplicationatbirth, @babyfirstfeed, 
@babyfirstfeedbreastmilkstatus, @birthordermaternitysus, @birthweight, @caesareandatetime, @careplandate, @careplantype, @ccg_resmother, @cigarettesperday, 
@complexsocialfactorsind, @complicatingdiagtypemother, @countymother, @dayofbirthbaby, @dayofdeathbaby, @dayssincedeliveryatdeathmother, @deathindicatormother, 
@decisiontodeliverdatetime, @deliverymethodbaby, @deliveryplacechangereasoncode, @dischargedatetimemotherdeliveryh, @eddagreed, @eddlastmenstrualperiod, @eddmethodagreed, 
@electoralwardmother, @employmentstatusmother, @employmentstatuspartner, @eopsmokingstatus, @episiotomyreason, @fetalorderultrasoundanomaly, @firstlanguageenglishindmother, 
@folicacidsupplement, @genitaltracttraumaticlesion, @gestagefirstcontact, @gestageformalantenatalbooking, @gestationdatingultrasound, @gestationlengthbirth, 
@hpsantenataldischargedate, @hpsantenatalstartdate, @investigationresultultrasoundfet, @labouranaesthesiatype, @labourinductionmethod, @labouronsetdatetime, 
@labouronsetpresentation, @labourpainreliefmethod, @lad_uamother, @lastmenstrualperioddate, @leadanteprovider, @leadpostprov, @leadprofessionaltype, @lengthtimefirststagelabour, 
@lsoamother2011, @maternitydischargedate, @maternityfamilyhistorydiagtypeat, @mcidatetime, @mcitype, @merofbirthbaby, @mhpredictiondetectionindmother, @monthofbirthbaby, 
@neonatalcriticalincidentdate, @neonatalcriticalincidenttype, @neonataldiag, @neonataldiagdate, @neonatalresuscitationmethod, @neonataltransferstartdatetime, @newbornphysicalexamresulteyes, 
@newbornphysicalexamresultheart, @newbornphysicalexamresulthips, @newbornphysicalexamresulttestes, @newbornphysicalscreeningdate, @nhsnumberstatusmother, @nofetusesdatingultrasound, 
@orgcodeccg_gpp, @orgcodecommissioner, @orgcodegmpmother, @orgcodepostnatalpathleadprovider, @orgcodeprovider, @oxytocinadministereddatetime, @persondeathdatetimebaby, 
@persondeathdatetimemother, @personheight, @personphenotypicsex, @personweight, @physicaldisabilitystatusindmothe, @placentadeliverymethod, @placetypeactualdelivery, 
@placetypeactualmidwifery, @placetypeintendeddelivery, @placetypeintendedmidwifery, @postcodedistrictmother, @postpartumhspdischargedatetime, @postpartumhspstartdatetime, 
@postpathlevel, @pregnancyfirstcontactcareprofess, @pregnancyfirstcontactdate, @pregnancymedicaldiagdate, @pregnancymedicaldiagtype, @pregnancyobstetricdiagdate, @pregnancyobstetricdiagtype, 
@pregnancyoutcomemonth, @pregnancyoutcomeyear, @previouscaesareansections, @previouscomplicatingdiagtypemoth, @previouslivebirths, @previouslosseslessthan24weeks, @previousstillbirths, 
@proceduredatedatingultrasound, @proceduredatetimefetalanomaly, @rank_imd_decile_2015, @romdatetime, @rommethod, @romreason, @sitecodeactualdelivery, @sitecodeadmittingneonatal, 
@sitecodeintendeddelivery, @skintoskincontact1hour, @smokingstatus, @startdatetimemotherdeliveryhps, @substanceusestatus, @supportstatusmother, @validnhsnoflag, @validpostcodeflag, 
@waterdeliveryind, @yearofbirthbaby)
SET
record_id_mother = nullif(@record_id_mother,''),
record_id_baby = nullif(@record_id_baby,''),
abnormalitydatingultrasound = nullif(@abnormalitydatingultrasound,''),
ageatbirthmother = nullif(@ageatbirthmother,''),
ageatbookingmother = nullif(@ageatbookingmother,''),
ageatdeathbaby = nullif(@ageatdeathbaby,''),
ageatdeathmother = nullif(@ageatdeathmother,''),
alcoholunitsperweek = nullif(@alcoholunitsperweek,''),
antenatalappactivitydate = nullif(@antenatalappactivitydate,''),
antenatalbookingappdate = nullif(@antenatalbookingappdate,''),
antepathlevel = nullif(@antepathlevel,''),
apgarscore5 = nullif(@apgarscore5,''),
babybreastmilkstatusdischarge = nullif(@babybreastmilkstatusdischarge,''),
babycomplicationatbirth = nullif(@babycomplicationatbirth,''),
babyfirstfeed = nullif(@babyfirstfeed,''),
babyfirstfeedbreastmilkstatus = nullif(@babyfirstfeedbreastmilkstatus,''),
birthordermaternitysus = nullif(@birthordermaternitysus,''),
birthweight = nullif(@birthweight,''),
caesareandatetime = nullif(@caesareandatetime,''),
careplandate = nullif(@careplandate,''),
careplantype = nullif(@careplantype,''),
ccg_resmother = nullif(@ccg_resmother,''),
cigarettesperday = nullif(@cigarettesperday,''),
complexsocialfactorsind = nullif(@complexsocialfactorsind,''),
complicatingdiagtypemother = nullif(@complicatingdiagtypemother,''),
countymother = nullif(@countymother,''),
dayofbirthbaby = nullif(@dayofbirthbaby,''),
dayofdeathbaby = nullif(@dayofdeathbaby,''),
dayssincedeliveryatdeathmother = nullif(@dayssincedeliveryatdeathmother,''),
deathindicatormother = nullif(@deathindicatormother,''),
decisiontodeliverdatetime = nullif(@decisiontodeliverdatetime,''),
deliverymethodbaby = nullif(@deliverymethodbaby,''),
deliveryplacechangereasoncode = nullif(@deliveryplacechangereasoncode,''),
dischargedatetimemotherdeliveryh = nullif(@dischargedatetimemotherdeliveryh,''),
eddagreed = nullif(@eddagreed,''),
eddlastmenstrualperiod = nullif(@eddlastmenstrualperiod,''),
eddmethodagreed = nullif(@eddmethodagreed,''),
electoralwardmother = nullif(@electoralwardmother,''),
employmentstatusmother = nullif(@employmentstatusmother,''),
employmentstatuspartner = nullif(@employmentstatuspartner,''),
eopsmokingstatus = nullif(@eopsmokingstatus,''),
episiotomyreason = nullif(@episiotomyreason,''),
fetalorderultrasoundanomaly = nullif(@fetalorderultrasoundanomaly,''),
firstlanguageenglishindmother = nullif(@firstlanguageenglishindmother,''),
folicacidsupplement = nullif(@folicacidsupplement,''),
genitaltracttraumaticlesion = nullif(@genitaltracttraumaticlesion,''),
gestagefirstcontact = nullif(@gestagefirstcontact,''),
gestageformalantenatalbooking = nullif(@gestageformalantenatalbooking,''),
gestationdatingultrasound = nullif(@gestationdatingultrasound,''),
gestationlengthbirth = nullif(@gestationlengthbirth,''),
hpsantenataldischargedate = nullif(@hpsantenataldischargedate,''),
hpsantenatalstartdate = nullif(@hpsantenatalstartdate,''),
investigationresultultrasoundfet = nullif(@investigationresultultrasoundfet,''),
labouranaesthesiatype = nullif(@labouranaesthesiatype,''),
labourinductionmethod = nullif(@labourinductionmethod,''),
labouronsetdatetime = nullif(@labouronsetdatetime,''),
labouronsetpresentation = nullif(@labouronsetpresentation,''),
labourpainreliefmethod = nullif(@labourpainreliefmethod,''),
lad_uamother = nullif(@lad_uamother,''),
lastmenstrualperioddate = nullif(@lastmenstrualperioddate,''),
leadanteprovider = nullif(@leadanteprovider,''),
leadpostprov = nullif(@leadpostprov,''),
leadprofessionaltype = nullif(@leadprofessionaltype,''),
lengthtimefirststagelabour = nullif(@lengthtimefirststagelabour,''),
lsoamother2011 = nullif(@lsoamother2011,''),
maternitydischargedate = nullif(@maternitydischargedate,''),
maternityfamilyhistorydiagtypeat = nullif(@maternityfamilyhistorydiagtypeat,''),
mcidatetime = nullif(@mcidatetime,''),
mcitype = nullif(@mcitype,''),
merofbirthbaby = nullif(@merofbirthbaby,''),
mhpredictiondetectionindmother = nullif(@mhpredictiondetectionindmother,''),
monthofbirthbaby = nullif(@monthofbirthbaby,''),
neonatalcriticalincidentdate = nullif(@neonatalcriticalincidentdate,''),
neonatalcriticalincidenttype = nullif(@neonatalcriticalincidenttype,''),
neonataldiag = nullif(@neonataldiag,''),
neonataldiagdate = nullif(@neonataldiagdate,''),
neonatalresuscitationmethod = nullif(@neonatalresuscitationmethod,''),
neonataltransferstartdatetime = nullif(@neonataltransferstartdatetime,''),
newbornphysicalexamresulteyes = nullif(@newbornphysicalexamresulteyes,''),
newbornphysicalexamresultheart = nullif(@newbornphysicalexamresultheart,''),
newbornphysicalexamresulthips = nullif(@newbornphysicalexamresulthips,''),
newbornphysicalexamresulttestes = nullif(@newbornphysicalexamresulttestes,''),
newbornphysicalscreeningdate = nullif(@newbornphysicalscreeningdate,''),
nhsnumberstatusmother = nullif(@nhsnumberstatusmother,''),
nofetusesdatingultrasound = nullif(@nofetusesdatingultrasound,''),
orgcodeccg_gpp = nullif(@orgcodeccg_gpp,''),
orgcodecommissioner = nullif(@orgcodecommissioner,''),
orgcodegmpmother = nullif(@orgcodegmpmother,''),
orgcodepostnatalpathleadprovider = nullif(@orgcodepostnatalpathleadprovider,''),
orgcodeprovider = nullif(@orgcodeprovider,''),
oxytocinadministereddatetime = nullif(@oxytocinadministereddatetime,''),
persondeathdatetimebaby = nullif(@persondeathdatetimebaby,''),
persondeathdatetimemother = nullif(@persondeathdatetimemother,''),
personheight = nullif(@personheight,''),
personphenotypicsex = nullif(@personphenotypicsex,''),
personweight = nullif(@personweight,''),
physicaldisabilitystatusindmothe = nullif(@physicaldisabilitystatusindmothe,''),
placentadeliverymethod = nullif(@placentadeliverymethod,''),
placetypeactualdelivery = nullif(@placetypeactualdelivery,''),
placetypeactualmidwifery = nullif(@placetypeactualmidwifery,''),
placetypeintendeddelivery = nullif(@placetypeintendeddelivery,''),
placetypeintendedmidwifery = nullif(@placetypeintendedmidwifery,''),
postcodedistrictmother = nullif(@postcodedistrictmother,''),
postpartumhspdischargedatetime = nullif(@postpartumhspdischargedatetime,''),
postpartumhspstartdatetime = nullif(@postpartumhspstartdatetime,''),
postpathlevel = nullif(@postpathlevel,''),
pregnancyfirstcontactcareprofess = nullif(@pregnancyfirstcontactcareprofess,''),
pregnancyfirstcontactdate = nullif(@pregnancyfirstcontactdate,''),
pregnancymedicaldiagdate = nullif(@pregnancymedicaldiagdate,''),
pregnancymedicaldiagtype = nullif(@pregnancymedicaldiagtype,''),
pregnancyobstetricdiagdate = nullif(@pregnancyobstetricdiagdate,''),
pregnancyobstetricdiagtype = nullif(@pregnancyobstetricdiagtype,''),
pregnancyoutcomemonth = nullif(@pregnancyoutcomemonth,''),
pregnancyoutcomeyear = nullif(@pregnancyoutcomeyear,''),
previouscaesareansections = nullif(@previouscaesareansections,''),
previouscomplicatingdiagtypemoth = nullif(@previouscomplicatingdiagtypemoth,''),
previouslivebirths = nullif(@previouslivebirths,''),
previouslosseslessthan24weeks = nullif(@previouslosseslessthan24weeks,''),
previousstillbirths = nullif(@previousstillbirths,''),
proceduredatedatingultrasound = nullif(@proceduredatedatingultrasound,''),
proceduredatetimefetalanomaly = nullif(@proceduredatetimefetalanomaly,''),
rank_imd_decile_2015 = nullif(@rank_imd_decile_2015,''),
romdatetime = nullif(@romdatetime,''),
rommethod = nullif(@rommethod,''),
romreason = nullif(@romreason,''),
sitecodeactualdelivery = nullif(@sitecodeactualdelivery,''),
sitecodeadmittingneonatal = nullif(@sitecodeadmittingneonatal,''),
sitecodeintendeddelivery = nullif(@sitecodeintendeddelivery,''),
skintoskincontact1hour = nullif(@skintoskincontact1hour,''),
smokingstatus = nullif(@smokingstatus,''),
startdatetimemotherdeliveryhps = nullif(@startdatetimemotherdeliveryhps,''),
substanceusestatus = nullif(@substanceusestatus,''),
supportstatusmother = nullif(@supportstatusmother,''),
validnhsnoflag = nullif(@validnhsnoflag,''),
validpostcodeflag = nullif(@validpostcodeflag,''),
waterdeliveryind = nullif(@waterdeliveryind,''),
yearofbirthbaby = nullif(@yearofbirthbaby,'')
;

CREATE INDEX recidmum on rekggth_hes_ons.MSDS_1516 (record_id_mother);
CREATE INDEX recidbaby on rekggth_hes_ons.MSDS_1516 (record_id_baby);

-- next year
CREATE TABLE rekggth_hes_ons.MSDS_1617 (
record_id_mother			varchar(7),
record_id_baby			varchar(7),
abnormalitydatingultrasound			varchar(3),
ageatbirthmother			smallint,
ageatbookingmother			smallint,
ageatdeathbaby			smallint,
ageatdeathmother			smallint,
alcoholunitsperweek			smallint,
antenatalappactivitydate			varchar(219),
antenatalbookingappdate			varchar(10),
antepathlevel			smallint,
apgarscore5			smallint,
babybreastmilkstatusdischarge			varchar(2),
babycomplicationatbirth			varchar(11),
babyfirstfeed			smallint,
babyfirstfeedbreastmilkstatus			varchar(2),
birthordermaternitysus			varchar(2),
birthweight			smallint,
caesareandatetime			datetime,
careplandate			varchar(54),
careplantype			varchar(14),
ccg_resmother			varchar(3),
cigarettesperday			smallint,
complexsocialfactorsind			varchar(1),
complicatingdiagtypemother			varchar(31),
countymother			varchar(9),
dayofbirthbaby			tinyint,
dayofdeathbaby			tinyint, 
dayssincedeliveryatdeathmother			smallint,
deathindicatormother			tinyint,
decisiontodeliverdatetime			datetime,
deliverymethodbaby			smallint,
deliveryplacechangereasoncode			varchar(9),
dischargedatetimemotherdeliveryh			datetime,
eddagreed			date,
eddlastmenstrualperiod			date,
eddmethodagreed			varchar(2),
electoralwardmother			varchar(9),
employmentstatusmother			varchar(2),
employmentstatuspartner			varchar(2),
eopsmokingstatus			varchar(7),
episiotomyreason			varchar(2),
fetalorderultrasoundanomaly			varchar(3),
firstlanguageenglishindmother			varchar(1),
folicacidsupplement			varchar(2),
genitaltracttraumaticlesion			varchar(14),
gestagefirstcontact			smallint,
gestageformalantenatalbooking			smallint,
gestationdatingultrasound			varchar(7),
gestationlengthbirth			smallint,
hpsantenataldischargedate			varchar(87),
hpsantenatalstartdate			varchar(87),
investigationresultultrasoundfet			varchar(5),
labouranaesthesiatype			varchar(11),
labourinductionmethod			varchar(5),
labouronsetdatetime			datetime,
labouronsetpresentation			varchar(2),
labourpainreliefmethod			varchar(20),
lad_uamother			varchar(9),
lastmenstrualperioddate			date,
leadanteprovider			varchar(3),
leadpostprov			varchar(5),
leadprofessionaltype			varchar(19),
lengthtimefirststagelabour			smallint,
lsoamother2011			varchar(9),
maternitydischargedate			varchar(43),
maternityfamilyhistorydiagtypeat			varchar(31),
mcidatetime			varchar(21),
mcitype			varchar(5),
merofbirthbaby			varchar(2),
mhpredictiondetectionindmother			varchar(1),
monthofbirthbaby			smallint,
neonatalcriticalincidentdate			varchar(54),
neonatalcriticalincidenttype			varchar(14),
neonataldiag			varchar(5),
neonataldiagdate			varchar(21),
neonatalresuscitationmethod			varchar(11),
neonataltransferstartdatetime			varchar(32),
newbornphysicalexamresulteyes			varchar(2),
newbornphysicalexamresultheart			varchar(2),
newbornphysicalexamresulthips			varchar(2),
newbornphysicalexamresulttestes			varchar(2),
newbornphysicalscreeningdate			date,
nhsnumberstatusmother			varchar(2),
nofetusesdatingultrasound			varchar(3),
orgcodeccg_gpp			varchar(3),
orgcodecommissioner			varchar(5),
orgcodegmpmother			varchar(6),
orgcodepostnatalpathleadprovider			varchar(5),
orgcodeprovider			varchar(3),
oxytocinadministereddatetime			varchar(21),
persondeathdatetimebaby			datetime,
persondeathdatetimemother			datetime,
personheight			float(6),
personphenotypicsex			varchar(1),
personweight			float(6),
physicaldisabilitystatusindmothe			varchar(1),
placentadeliverymethod			varchar(2),
placetypeactualdelivery			varchar(1),
placetypeactualmidwifery			varchar(1),
placetypeintendeddelivery			varchar(9),
placetypeintendedmidwifery			varchar(9),
postcodedistrictmother			varchar(4),
postpartumhspdischargedatetime			varchar(43),
postpartumhspstartdatetime			varchar(43),
postpathlevel			varchar(19),
pregnancyfirstcontactcareprofess			varchar(19),
pregnancyfirstcontactdate			varchar(43),
pregnancymedicaldiagdate			varchar(43),
pregnancymedicaldiagtype			varchar(14),
pregnancyobstetricdiagdate			varchar(54),
pregnancyobstetricdiagtype			varchar(14),
pregnancyoutcomemonth			smallint,
pregnancyoutcomeyear			smallint,
previouscaesareansections			smallint,
previouscomplicatingdiagtypemoth			varchar(19),
previouslivebirths			smallint,
previouslosseslessthan24weeks			smallint,
previousstillbirths			smallint,
proceduredatedatingultrasound			varchar(21),
proceduredatetimefetalanomaly			varchar(21),
rank_imd_decile_2015			varchar(19),
romdatetime			datetime,
rommethod			varchar(2),
romreason			varchar(2),
sitecodeactualdelivery			varchar(6),
sitecodeadmittingneonatal			varchar(17),
sitecodeintendeddelivery			varchar(29),
skintoskincontact1hour			varchar(1),
smokingstatus			varchar(2),
startdatetimemotherdeliveryhps			datetime,
substanceusestatus			varchar(2),
supportstatusmother			varchar(1),
validnhsnoflag			varchar(1),
validpostcodeflag			varchar(1),
waterdeliveryind			varchar(1),
yearofbirthbaby			smallint
)
;

LOAD DATA LOCAL INFILE '~path/NIC393510_MSDS_1617_R.txt'
INTO TABLE rekggth_hes_ons.MSDS_1617
fields terminated by "\t"
lines terminated by "\n"
ignore 1 lines
(@record_id_mother, @record_id_baby, @abnormalitydatingultrasound, @ageatbirthmother, @ageatbookingmother, @ageatdeathbaby, @ageatdeathmother, @alcoholunitsperweek, 
@antenatalappactivitydate, @antenatalbookingappdate, @antepathlevel, @apgarscore5, @babybreastmilkstatusdischarge, @babycomplicationatbirth, @babyfirstfeed, 
@babyfirstfeedbreastmilkstatus, @birthordermaternitysus, @birthweight, @caesareandatetime, @careplandate, @careplantype, @ccg_resmother, @cigarettesperday, 
@complexsocialfactorsind, @complicatingdiagtypemother, @countymother, @dayofbirthbaby, @dayofdeathbaby, @dayssincedeliveryatdeathmother, @deathindicatormother, 
@decisiontodeliverdatetime, @deliverymethodbaby, @deliveryplacechangereasoncode, @dischargedatetimemotherdeliveryh, @eddagreed, @eddlastmenstrualperiod, @eddmethodagreed, 
@electoralwardmother, @employmentstatusmother, @employmentstatuspartner, @eopsmokingstatus, @episiotomyreason, @fetalorderultrasoundanomaly, @firstlanguageenglishindmother, 
@folicacidsupplement, @genitaltracttraumaticlesion, @gestagefirstcontact, @gestageformalantenatalbooking, @gestationdatingultrasound, @gestationlengthbirth, 
@hpsantenataldischargedate, @hpsantenatalstartdate, @investigationresultultrasoundfet, @labouranaesthesiatype, @labourinductionmethod, @labouronsetdatetime, 
@labouronsetpresentation, @labourpainreliefmethod, @lad_uamother, @lastmenstrualperioddate, @leadanteprovider, @leadpostprov, @leadprofessionaltype, @lengthtimefirststagelabour, 
@lsoamother2011, @maternitydischargedate, @maternityfamilyhistorydiagtypeat, @mcidatetime, @mcitype, @merofbirthbaby, @mhpredictiondetectionindmother, @monthofbirthbaby, 
@neonatalcriticalincidentdate, @neonatalcriticalincidenttype, @neonataldiag, @neonataldiagdate, @neonatalresuscitationmethod, @neonataltransferstartdatetime, @newbornphysicalexamresulteyes, 
@newbornphysicalexamresultheart, @newbornphysicalexamresulthips, @newbornphysicalexamresulttestes, @newbornphysicalscreeningdate, @nhsnumberstatusmother, @nofetusesdatingultrasound, 
@orgcodeccg_gpp, @orgcodecommissioner, @orgcodegmpmother, @orgcodepostnatalpathleadprovider, @orgcodeprovider, @oxytocinadministereddatetime, @persondeathdatetimebaby, 
@persondeathdatetimemother, @personheight, @personphenotypicsex, @personweight, @physicaldisabilitystatusindmothe, @placentadeliverymethod, @placetypeactualdelivery, 
@placetypeactualmidwifery, @placetypeintendeddelivery, @placetypeintendedmidwifery, @postcodedistrictmother, @postpartumhspdischargedatetime, @postpartumhspstartdatetime, 
@postpathlevel, @pregnancyfirstcontactcareprofess, @pregnancyfirstcontactdate, @pregnancymedicaldiagdate, @pregnancymedicaldiagtype, @pregnancyobstetricdiagdate, @pregnancyobstetricdiagtype, 
@pregnancyoutcomemonth, @pregnancyoutcomeyear, @previouscaesareansections, @previouscomplicatingdiagtypemoth, @previouslivebirths, @previouslosseslessthan24weeks, @previousstillbirths, 
@proceduredatedatingultrasound, @proceduredatetimefetalanomaly, @rank_imd_decile_2015, @romdatetime, @rommethod, @romreason, @sitecodeactualdelivery, @sitecodeadmittingneonatal, 
@sitecodeintendeddelivery, @skintoskincontact1hour, @smokingstatus, @startdatetimemotherdeliveryhps, @substanceusestatus, @supportstatusmother, @validnhsnoflag, @validpostcodeflag, 
@waterdeliveryind, @yearofbirthbaby)
SET
record_id_mother = nullif(@record_id_mother,''),
record_id_baby = nullif(@record_id_baby,''),
abnormalitydatingultrasound = nullif(@abnormalitydatingultrasound,''),
ageatbirthmother = nullif(@ageatbirthmother,''),
ageatbookingmother = nullif(@ageatbookingmother,''),
ageatdeathbaby = nullif(@ageatdeathbaby,''),
ageatdeathmother = nullif(@ageatdeathmother,''),
alcoholunitsperweek = nullif(@alcoholunitsperweek,''),
antenatalappactivitydate = nullif(@antenatalappactivitydate,''),
antenatalbookingappdate = nullif(@antenatalbookingappdate,''),
antepathlevel = nullif(@antepathlevel,''),
apgarscore5 = nullif(@apgarscore5,''),
babybreastmilkstatusdischarge = nullif(@babybreastmilkstatusdischarge,''),
babycomplicationatbirth = nullif(@babycomplicationatbirth,''),
babyfirstfeed = nullif(@babyfirstfeed,''),
babyfirstfeedbreastmilkstatus = nullif(@babyfirstfeedbreastmilkstatus,''),
birthordermaternitysus = nullif(@birthordermaternitysus,''),
birthweight = nullif(@birthweight,''),
caesareandatetime = nullif(@caesareandatetime,''),
careplandate = nullif(@careplandate,''),
careplantype = nullif(@careplantype,''),
ccg_resmother = nullif(@ccg_resmother,''),
cigarettesperday = nullif(@cigarettesperday,''),
complexsocialfactorsind = nullif(@complexsocialfactorsind,''),
complicatingdiagtypemother = nullif(@complicatingdiagtypemother,''),
countymother = nullif(@countymother,''),
dayofbirthbaby = nullif(@dayofbirthbaby,''),
dayofdeathbaby = nullif(@dayofdeathbaby,''),
dayssincedeliveryatdeathmother = nullif(@dayssincedeliveryatdeathmother,''),
deathindicatormother = nullif(@deathindicatormother,''),
decisiontodeliverdatetime = nullif(@decisiontodeliverdatetime,''),
deliverymethodbaby = nullif(@deliverymethodbaby,''),
deliveryplacechangereasoncode = nullif(@deliveryplacechangereasoncode,''),
dischargedatetimemotherdeliveryh = nullif(@dischargedatetimemotherdeliveryh,''),
eddagreed = nullif(@eddagreed,''),
eddlastmenstrualperiod = nullif(@eddlastmenstrualperiod,''),
eddmethodagreed = nullif(@eddmethodagreed,''),
electoralwardmother = nullif(@electoralwardmother,''),
employmentstatusmother = nullif(@employmentstatusmother,''),
employmentstatuspartner = nullif(@employmentstatuspartner,''),
eopsmokingstatus = nullif(@eopsmokingstatus,''),
episiotomyreason = nullif(@episiotomyreason,''),
fetalorderultrasoundanomaly = nullif(@fetalorderultrasoundanomaly,''),
firstlanguageenglishindmother = nullif(@firstlanguageenglishindmother,''),
folicacidsupplement = nullif(@folicacidsupplement,''),
genitaltracttraumaticlesion = nullif(@genitaltracttraumaticlesion,''),
gestagefirstcontact = nullif(@gestagefirstcontact,''),
gestageformalantenatalbooking = nullif(@gestageformalantenatalbooking,''),
gestationdatingultrasound = nullif(@gestationdatingultrasound,''),
gestationlengthbirth = nullif(@gestationlengthbirth,''),
hpsantenataldischargedate = nullif(@hpsantenataldischargedate,''),
hpsantenatalstartdate = nullif(@hpsantenatalstartdate,''),
investigationresultultrasoundfet = nullif(@investigationresultultrasoundfet,''),
labouranaesthesiatype = nullif(@labouranaesthesiatype,''),
labourinductionmethod = nullif(@labourinductionmethod,''),
labouronsetdatetime = nullif(@labouronsetdatetime,''),
labouronsetpresentation = nullif(@labouronsetpresentation,''),
labourpainreliefmethod = nullif(@labourpainreliefmethod,''),
lad_uamother = nullif(@lad_uamother,''),
lastmenstrualperioddate = nullif(@lastmenstrualperioddate,''),
leadanteprovider = nullif(@leadanteprovider,''),
leadpostprov = nullif(@leadpostprov,''),
leadprofessionaltype = nullif(@leadprofessionaltype,''),
lengthtimefirststagelabour = nullif(@lengthtimefirststagelabour,''),
lsoamother2011 = nullif(@lsoamother2011,''),
maternitydischargedate = nullif(@maternitydischargedate,''),
maternityfamilyhistorydiagtypeat = nullif(@maternityfamilyhistorydiagtypeat,''),
mcidatetime = nullif(@mcidatetime,''),
mcitype = nullif(@mcitype,''),
merofbirthbaby = nullif(@merofbirthbaby,''),
mhpredictiondetectionindmother = nullif(@mhpredictiondetectionindmother,''),
monthofbirthbaby = nullif(@monthofbirthbaby,''),
neonatalcriticalincidentdate = nullif(@neonatalcriticalincidentdate,''),
neonatalcriticalincidenttype = nullif(@neonatalcriticalincidenttype,''),
neonataldiag = nullif(@neonataldiag,''),
neonataldiagdate = nullif(@neonataldiagdate,''),
neonatalresuscitationmethod = nullif(@neonatalresuscitationmethod,''),
neonataltransferstartdatetime = nullif(@neonataltransferstartdatetime,''),
newbornphysicalexamresulteyes = nullif(@newbornphysicalexamresulteyes,''),
newbornphysicalexamresultheart = nullif(@newbornphysicalexamresultheart,''),
newbornphysicalexamresulthips = nullif(@newbornphysicalexamresulthips,''),
newbornphysicalexamresulttestes = nullif(@newbornphysicalexamresulttestes,''),
newbornphysicalscreeningdate = nullif(@newbornphysicalscreeningdate,''),
nhsnumberstatusmother = nullif(@nhsnumberstatusmother,''),
nofetusesdatingultrasound = nullif(@nofetusesdatingultrasound,''),
orgcodeccg_gpp = nullif(@orgcodeccg_gpp,''),
orgcodecommissioner = nullif(@orgcodecommissioner,''),
orgcodegmpmother = nullif(@orgcodegmpmother,''),
orgcodepostnatalpathleadprovider = nullif(@orgcodepostnatalpathleadprovider,''),
orgcodeprovider = nullif(@orgcodeprovider,''),
oxytocinadministereddatetime = nullif(@oxytocinadministereddatetime,''),
persondeathdatetimebaby = nullif(@persondeathdatetimebaby,''),
persondeathdatetimemother = nullif(@persondeathdatetimemother,''),
personheight = nullif(@personheight,''),
personphenotypicsex = nullif(@personphenotypicsex,''),
personweight = nullif(@personweight,''),
physicaldisabilitystatusindmothe = nullif(@physicaldisabilitystatusindmothe,''),
placentadeliverymethod = nullif(@placentadeliverymethod,''),
placetypeactualdelivery = nullif(@placetypeactualdelivery,''),
placetypeactualmidwifery = nullif(@placetypeactualmidwifery,''),
placetypeintendeddelivery = nullif(@placetypeintendeddelivery,''),
placetypeintendedmidwifery = nullif(@placetypeintendedmidwifery,''),
postcodedistrictmother = nullif(@postcodedistrictmother,''),
postpartumhspdischargedatetime = nullif(@postpartumhspdischargedatetime,''),
postpartumhspstartdatetime = nullif(@postpartumhspstartdatetime,''),
postpathlevel = nullif(@postpathlevel,''),
pregnancyfirstcontactcareprofess = nullif(@pregnancyfirstcontactcareprofess,''),
pregnancyfirstcontactdate = nullif(@pregnancyfirstcontactdate,''),
pregnancymedicaldiagdate = nullif(@pregnancymedicaldiagdate,''),
pregnancymedicaldiagtype = nullif(@pregnancymedicaldiagtype,''),
pregnancyobstetricdiagdate = nullif(@pregnancyobstetricdiagdate,''),
pregnancyobstetricdiagtype = nullif(@pregnancyobstetricdiagtype,''),
pregnancyoutcomemonth = nullif(@pregnancyoutcomemonth,''),
pregnancyoutcomeyear = nullif(@pregnancyoutcomeyear,''),
previouscaesareansections = nullif(@previouscaesareansections,''),
previouscomplicatingdiagtypemoth = nullif(@previouscomplicatingdiagtypemoth,''),
previouslivebirths = nullif(@previouslivebirths,''),
previouslosseslessthan24weeks = nullif(@previouslosseslessthan24weeks,''),
previousstillbirths = nullif(@previousstillbirths,''),
proceduredatedatingultrasound = nullif(@proceduredatedatingultrasound,''),
proceduredatetimefetalanomaly = nullif(@proceduredatetimefetalanomaly,''),
rank_imd_decile_2015 = nullif(@rank_imd_decile_2015,''),
romdatetime = nullif(@romdatetime,''),
rommethod = nullif(@rommethod,''),
romreason = nullif(@romreason,''),
sitecodeactualdelivery = nullif(@sitecodeactualdelivery,''),
sitecodeadmittingneonatal = nullif(@sitecodeadmittingneonatal,''),
sitecodeintendeddelivery = nullif(@sitecodeintendeddelivery,''),
skintoskincontact1hour = nullif(@skintoskincontact1hour,''),
smokingstatus = nullif(@smokingstatus,''),
startdatetimemotherdeliveryhps = nullif(@startdatetimemotherdeliveryhps,''),
substanceusestatus = nullif(@substanceusestatus,''),
supportstatusmother = nullif(@supportstatusmother,''),
validnhsnoflag = nullif(@validnhsnoflag,''),
validpostcodeflag = nullif(@validpostcodeflag,''),
waterdeliveryind = nullif(@waterdeliveryind,''),
yearofbirthbaby = nullif(@yearofbirthbaby,'\n'),
yearofbirthbaby = nullif(@yearofbirthbaby,'')
;

CREATE INDEX recidmum on rekggth_hes_ons.MSDS_1617 (record_id_mother);
CREATE INDEX recidbaby on rekggth_hes_ons.MSDS_1617 (record_id_baby);

-- and the next year
CREATE TABLE rekggth_hes_ons.MSDS_1718 (
record_id_mother			varchar(7),
record_id_baby			varchar(7),
abnormalitydatingultrasound			varchar(3),
ageatbirthmother			smallint,
ageatbookingmother			smallint,
ageatdeathbaby			smallint,
ageatdeathmother			smallint,
alcoholunitsperweek			smallint,
antenatalappactivitydate			varchar(219),
antenatalbookingappdate			varchar(10),
antepathlevel			smallint,
apgarscore5			smallint,
babybreastmilkstatusdischarge			varchar(2),
babycomplicationatbirth			varchar(11),
babyfirstfeed			smallint,
babyfirstfeedbreastmilkstatus			varchar(2),
birthordermaternitysus			varchar(2),
birthweight			smallint,
caesareandatetime			datetime,
careplandate			varchar(54),
careplantype			varchar(14),
ccg_resmother			varchar(3),
cigarettesperday			smallint,
complexsocialfactorsind			varchar(1),
complicatingdiagtypemother			varchar(31),
countymother			varchar(9),
dayofbirthbaby			tinyint,
dayofdeathbaby			tinyint, 
dayssincedeliveryatdeathmother			smallint,
deathindicatormother			tinyint,
decisiontodeliverdatetime			datetime,
deliverymethodbaby			smallint,
deliveryplacechangereasoncode			varchar(9),
dischargedatetimemotherdeliveryh			datetime,
eddagreed			date,
eddlastmenstrualperiod			date,
eddmethodagreed			varchar(2),
electoralwardmother			varchar(9),
employmentstatusmother			varchar(2),
employmentstatuspartner			varchar(2),
eopsmokingstatus			varchar(7),
episiotomyreason			varchar(2),
fetalorderultrasoundanomaly			varchar(3),
firstlanguageenglishindmother			varchar(1),
folicacidsupplement			varchar(2),
genitaltracttraumaticlesion			varchar(14),
gestagefirstcontact			smallint,
gestageformalantenatalbooking			smallint,
gestationdatingultrasound			varchar(7),
gestationlengthbirth			smallint,
hpsantenataldischargedate			varchar(87),
hpsantenatalstartdate			varchar(87),
investigationresultultrasoundfet			varchar(5),
labouranaesthesiatype			varchar(11),
labourinductionmethod			varchar(5),
labouronsetdatetime			datetime,
labouronsetpresentation			varchar(2),
labourpainreliefmethod			varchar(20),
lad_uamother			varchar(9),
lastmenstrualperioddate			date,
leadanteprovider			varchar(3),
leadpostprov			varchar(5),
leadprofessionaltype			varchar(19),
lengthtimefirststagelabour			smallint,
lsoamother2011			varchar(9),
maternitydischargedate			varchar(43),
maternityfamilyhistorydiagtypeat			varchar(31),
mcidatetime			varchar(21),
mcitype			varchar(5),
merofbirthbaby			varchar(2),
mhpredictiondetectionindmother			varchar(1),
monthofbirthbaby			smallint,
neonatalcriticalincidentdate			varchar(54),
neonatalcriticalincidenttype			varchar(14),
neonataldiag			varchar(5),
neonataldiagdate			varchar(21),
neonatalresuscitationmethod			varchar(11),
neonataltransferstartdatetime			varchar(32),
newbornphysicalexamresulteyes			varchar(2),
newbornphysicalexamresultheart			varchar(2),
newbornphysicalexamresulthips			varchar(2),
newbornphysicalexamresulttestes			varchar(2),
newbornphysicalscreeningdate			date,
nhsnumberstatusmother			varchar(2),
nofetusesdatingultrasound			varchar(3),
orgcodeccg_gpp			varchar(3),
orgcodecommissioner			varchar(5),
orgcodegmpmother			varchar(6),
orgcodepostnatalpathleadprovider			varchar(5),
orgcodeprovider			varchar(3),
oxytocinadministereddatetime			varchar(21),
persondeathdatetimebaby			datetime,
persondeathdatetimemother			datetime,
personheight			float(6),
personphenotypicsex			varchar(1),
personweight			float(6),
physicaldisabilitystatusindmothe			varchar(1),
placentadeliverymethod			varchar(2),
placetypeactualdelivery			varchar(1),
placetypeactualmidwifery			varchar(1),
placetypeintendeddelivery			varchar(9),
placetypeintendedmidwifery			varchar(9),
postcodedistrictmother			varchar(4),
postpartumhspdischargedatetime			varchar(43),
postpartumhspstartdatetime			varchar(43),
postpathlevel			varchar(19),
pregnancyfirstcontactcareprofess			varchar(19),
pregnancyfirstcontactdate			varchar(43),
pregnancymedicaldiagdate			varchar(43),
pregnancymedicaldiagtype			varchar(14),
pregnancyobstetricdiagdate			varchar(54),
pregnancyobstetricdiagtype			varchar(14),
pregnancyoutcomemonth			smallint,
pregnancyoutcomeyear			smallint,
previouscaesareansections			smallint,
previouscomplicatingdiagtypemoth			varchar(19),
previouslivebirths			smallint,
previouslosseslessthan24weeks			smallint,
previousstillbirths			smallint,
proceduredatedatingultrasound			varchar(21),
proceduredatetimefetalanomaly			varchar(21),
rank_imd_decile_2015			varchar(19),
romdatetime			datetime,
rommethod			varchar(2),
romreason			varchar(2),
sitecodeactualdelivery			varchar(6),
sitecodeadmittingneonatal			varchar(17),
sitecodeintendeddelivery			varchar(29),
skintoskincontact1hour			varchar(1),
smokingstatus			varchar(2),
startdatetimemotherdeliveryhps			datetime,
substanceusestatus			varchar(2),
supportstatusmother			varchar(1),
validnhsnoflag			varchar(1),
validpostcodeflag			varchar(1),
waterdeliveryind			varchar(1),
yearofbirthbaby			smallint
)
;

LOAD DATA LOCAL INFILE '~path/NIC393510_MSDS_1718_R.txt'
INTO TABLE rekggth_hes_ons.MSDS_1718
fields terminated by "\t"
lines terminated by "\n"
ignore 1 lines
(@record_id_mother, @record_id_baby, @abnormalitydatingultrasound, @ageatbirthmother, @ageatbookingmother, @ageatdeathbaby, @ageatdeathmother, @alcoholunitsperweek, 
@antenatalappactivitydate, @antenatalbookingappdate, @antepathlevel, @apgarscore5, @babybreastmilkstatusdischarge, @babycomplicationatbirth, @babyfirstfeed, 
@babyfirstfeedbreastmilkstatus, @birthordermaternitysus, @birthweight, @caesareandatetime, @careplandate, @careplantype, @ccg_resmother, @cigarettesperday, 
@complexsocialfactorsind, @complicatingdiagtypemother, @countymother, @dayofbirthbaby, @dayofdeathbaby, @dayssincedeliveryatdeathmother, @deathindicatormother, 
@decisiontodeliverdatetime, @deliverymethodbaby, @deliveryplacechangereasoncode, @dischargedatetimemotherdeliveryh, @eddagreed, @eddlastmenstrualperiod, @eddmethodagreed, 
@electoralwardmother, @employmentstatusmother, @employmentstatuspartner, @eopsmokingstatus, @episiotomyreason, @fetalorderultrasoundanomaly, @firstlanguageenglishindmother, 
@folicacidsupplement, @genitaltracttraumaticlesion, @gestagefirstcontact, @gestageformalantenatalbooking, @gestationdatingultrasound, @gestationlengthbirth, 
@hpsantenataldischargedate, @hpsantenatalstartdate, @investigationresultultrasoundfet, @labouranaesthesiatype, @labourinductionmethod, @labouronsetdatetime, 
@labouronsetpresentation, @labourpainreliefmethod, @lad_uamother, @lastmenstrualperioddate, @leadanteprovider, @leadpostprov, @leadprofessionaltype, @lengthtimefirststagelabour, 
@lsoamother2011, @maternitydischargedate, @maternityfamilyhistorydiagtypeat, @mcidatetime, @mcitype, @merofbirthbaby, @mhpredictiondetectionindmother, @monthofbirthbaby, 
@neonatalcriticalincidentdate, @neonatalcriticalincidenttype, @neonataldiag, @neonataldiagdate, @neonatalresuscitationmethod, @neonataltransferstartdatetime, @newbornphysicalexamresulteyes, 
@newbornphysicalexamresultheart, @newbornphysicalexamresulthips, @newbornphysicalexamresulttestes, @newbornphysicalscreeningdate, @nhsnumberstatusmother, @nofetusesdatingultrasound, 
@orgcodeccg_gpp, @orgcodecommissioner, @orgcodegmpmother, @orgcodepostnatalpathleadprovider, @orgcodeprovider, @oxytocinadministereddatetime, @persondeathdatetimebaby, 
@persondeathdatetimemother, @personheight, @personphenotypicsex, @personweight, @physicaldisabilitystatusindmothe, @placentadeliverymethod, @placetypeactualdelivery, 
@placetypeactualmidwifery, @placetypeintendeddelivery, @placetypeintendedmidwifery, @postcodedistrictmother, @postpartumhspdischargedatetime, @postpartumhspstartdatetime, 
@postpathlevel, @pregnancyfirstcontactcareprofess, @pregnancyfirstcontactdate, @pregnancymedicaldiagdate, @pregnancymedicaldiagtype, @pregnancyobstetricdiagdate, @pregnancyobstetricdiagtype, 
@pregnancyoutcomemonth, @pregnancyoutcomeyear, @previouscaesareansections, @previouscomplicatingdiagtypemoth, @previouslivebirths, @previouslosseslessthan24weeks, @previousstillbirths, 
@proceduredatedatingultrasound, @proceduredatetimefetalanomaly, @rank_imd_decile_2015, @romdatetime, @rommethod, @romreason, @sitecodeactualdelivery, @sitecodeadmittingneonatal, 
@sitecodeintendeddelivery, @skintoskincontact1hour, @smokingstatus, @startdatetimemotherdeliveryhps, @substanceusestatus, @supportstatusmother, @validnhsnoflag, @validpostcodeflag, 
@waterdeliveryind, @yearofbirthbaby)
SET
record_id_mother = nullif(@record_id_mother,''),
record_id_baby = nullif(@record_id_baby,''),
abnormalitydatingultrasound = nullif(@abnormalitydatingultrasound,''),
ageatbirthmother = nullif(@ageatbirthmother,''),
ageatbookingmother = nullif(@ageatbookingmother,''),
ageatdeathbaby = nullif(@ageatdeathbaby,''),
ageatdeathmother = nullif(@ageatdeathmother,''),
alcoholunitsperweek = nullif(@alcoholunitsperweek,''),
antenatalappactivitydate = nullif(@antenatalappactivitydate,''),
antenatalbookingappdate = nullif(@antenatalbookingappdate,''),
antepathlevel = nullif(@antepathlevel,''),
apgarscore5 = nullif(@apgarscore5,''),
babybreastmilkstatusdischarge = nullif(@babybreastmilkstatusdischarge,''),
babycomplicationatbirth = nullif(@babycomplicationatbirth,''),
babyfirstfeed = nullif(@babyfirstfeed,''),
babyfirstfeedbreastmilkstatus = nullif(@babyfirstfeedbreastmilkstatus,''),
birthordermaternitysus = nullif(@birthordermaternitysus,''),
birthweight = nullif(@birthweight,''),
caesareandatetime = nullif(@caesareandatetime,''),
careplandate = nullif(@careplandate,''),
careplantype = nullif(@careplantype,''),
ccg_resmother = nullif(@ccg_resmother,''),
cigarettesperday = nullif(@cigarettesperday,''),
complexsocialfactorsind = nullif(@complexsocialfactorsind,''),
complicatingdiagtypemother = nullif(@complicatingdiagtypemother,''),
countymother = nullif(@countymother,''),
dayofbirthbaby = nullif(@dayofbirthbaby,''),
dayofdeathbaby = nullif(@dayofdeathbaby,''),
dayssincedeliveryatdeathmother = nullif(@dayssincedeliveryatdeathmother,''),
deathindicatormother = nullif(@deathindicatormother,''),
decisiontodeliverdatetime = nullif(@decisiontodeliverdatetime,''),
deliverymethodbaby = nullif(@deliverymethodbaby,''),
deliveryplacechangereasoncode = nullif(@deliveryplacechangereasoncode,''),
dischargedatetimemotherdeliveryh = nullif(@dischargedatetimemotherdeliveryh,''),
eddagreed = nullif(@eddagreed,''),
eddlastmenstrualperiod = nullif(@eddlastmenstrualperiod,''),
eddmethodagreed = nullif(@eddmethodagreed,''),
electoralwardmother = nullif(@electoralwardmother,''),
employmentstatusmother = nullif(@employmentstatusmother,''),
employmentstatuspartner = nullif(@employmentstatuspartner,''),
eopsmokingstatus = nullif(@eopsmokingstatus,''),
episiotomyreason = nullif(@episiotomyreason,''),
fetalorderultrasoundanomaly = nullif(@fetalorderultrasoundanomaly,''),
firstlanguageenglishindmother = nullif(@firstlanguageenglishindmother,''),
folicacidsupplement = nullif(@folicacidsupplement,''),
genitaltracttraumaticlesion = nullif(@genitaltracttraumaticlesion,''),
gestagefirstcontact = nullif(@gestagefirstcontact,''),
gestageformalantenatalbooking = nullif(@gestageformalantenatalbooking,''),
gestationdatingultrasound = nullif(@gestationdatingultrasound,''),
gestationlengthbirth = nullif(@gestationlengthbirth,''),
hpsantenataldischargedate = nullif(@hpsantenataldischargedate,''),
hpsantenatalstartdate = nullif(@hpsantenatalstartdate,''),
investigationresultultrasoundfet = nullif(@investigationresultultrasoundfet,''),
labouranaesthesiatype = nullif(@labouranaesthesiatype,''),
labourinductionmethod = nullif(@labourinductionmethod,''),
labouronsetdatetime = nullif(@labouronsetdatetime,''),
labouronsetpresentation = nullif(@labouronsetpresentation,''),
labourpainreliefmethod = nullif(@labourpainreliefmethod,''),
lad_uamother = nullif(@lad_uamother,''),
lastmenstrualperioddate = nullif(@lastmenstrualperioddate,''),
leadanteprovider = nullif(@leadanteprovider,''),
leadpostprov = nullif(@leadpostprov,''),
leadprofessionaltype = nullif(@leadprofessionaltype,''),
lengthtimefirststagelabour = nullif(@lengthtimefirststagelabour,''),
lsoamother2011 = nullif(@lsoamother2011,''),
maternitydischargedate = nullif(@maternitydischargedate,''),
maternityfamilyhistorydiagtypeat = nullif(@maternityfamilyhistorydiagtypeat,''),
mcidatetime = nullif(@mcidatetime,''),
mcitype = nullif(@mcitype,''),
merofbirthbaby = nullif(@merofbirthbaby,''),
mhpredictiondetectionindmother = nullif(@mhpredictiondetectionindmother,''),
monthofbirthbaby = nullif(@monthofbirthbaby,''),
neonatalcriticalincidentdate = nullif(@neonatalcriticalincidentdate,''),
neonatalcriticalincidenttype = nullif(@neonatalcriticalincidenttype,''),
neonataldiag = nullif(@neonataldiag,''),
neonataldiagdate = nullif(@neonataldiagdate,''),
neonatalresuscitationmethod = nullif(@neonatalresuscitationmethod,''),
neonataltransferstartdatetime = nullif(@neonataltransferstartdatetime,''),
newbornphysicalexamresulteyes = nullif(@newbornphysicalexamresulteyes,''),
newbornphysicalexamresultheart = nullif(@newbornphysicalexamresultheart,''),
newbornphysicalexamresulthips = nullif(@newbornphysicalexamresulthips,''),
newbornphysicalexamresulttestes = nullif(@newbornphysicalexamresulttestes,''),
newbornphysicalscreeningdate = nullif(@newbornphysicalscreeningdate,''),
nhsnumberstatusmother = nullif(@nhsnumberstatusmother,''),
nofetusesdatingultrasound = nullif(@nofetusesdatingultrasound,''),
orgcodeccg_gpp = nullif(@orgcodeccg_gpp,''),
orgcodecommissioner = nullif(@orgcodecommissioner,''),
orgcodegmpmother = nullif(@orgcodegmpmother,''),
orgcodepostnatalpathleadprovider = nullif(@orgcodepostnatalpathleadprovider,''),
orgcodeprovider = nullif(@orgcodeprovider,''),
oxytocinadministereddatetime = nullif(@oxytocinadministereddatetime,''),
persondeathdatetimebaby = nullif(@persondeathdatetimebaby,''),
persondeathdatetimemother = nullif(@persondeathdatetimemother,''),
personheight = nullif(@personheight,''),
personphenotypicsex = nullif(@personphenotypicsex,''),
personweight = nullif(@personweight,''),
physicaldisabilitystatusindmothe = nullif(@physicaldisabilitystatusindmothe,''),
placentadeliverymethod = nullif(@placentadeliverymethod,''),
placetypeactualdelivery = nullif(@placetypeactualdelivery,''),
placetypeactualmidwifery = nullif(@placetypeactualmidwifery,''),
placetypeintendeddelivery = nullif(@placetypeintendeddelivery,''),
placetypeintendedmidwifery = nullif(@placetypeintendedmidwifery,''),
postcodedistrictmother = nullif(@postcodedistrictmother,''),
postpartumhspdischargedatetime = nullif(@postpartumhspdischargedatetime,''),
postpartumhspstartdatetime = nullif(@postpartumhspstartdatetime,''),
postpathlevel = nullif(@postpathlevel,''),
pregnancyfirstcontactcareprofess = nullif(@pregnancyfirstcontactcareprofess,''),
pregnancyfirstcontactdate = nullif(@pregnancyfirstcontactdate,''),
pregnancymedicaldiagdate = nullif(@pregnancymedicaldiagdate,''),
pregnancymedicaldiagtype = nullif(@pregnancymedicaldiagtype,''),
pregnancyobstetricdiagdate = nullif(@pregnancyobstetricdiagdate,''),
pregnancyobstetricdiagtype = nullif(@pregnancyobstetricdiagtype,''),
pregnancyoutcomemonth = nullif(@pregnancyoutcomemonth,''),
pregnancyoutcomeyear = nullif(@pregnancyoutcomeyear,''),
previouscaesareansections = nullif(@previouscaesareansections,''),
previouscomplicatingdiagtypemoth = nullif(@previouscomplicatingdiagtypemoth,''),
previouslivebirths = nullif(@previouslivebirths,''),
previouslosseslessthan24weeks = nullif(@previouslosseslessthan24weeks,''),
previousstillbirths = nullif(@previousstillbirths,''),
proceduredatedatingultrasound = nullif(@proceduredatedatingultrasound,''),
proceduredatetimefetalanomaly = nullif(@proceduredatetimefetalanomaly,''),
rank_imd_decile_2015 = nullif(@rank_imd_decile_2015,''),
romdatetime = nullif(@romdatetime,''),
rommethod = nullif(@rommethod,''),
romreason = nullif(@romreason,''),
sitecodeactualdelivery = nullif(@sitecodeactualdelivery,''),
sitecodeadmittingneonatal = nullif(@sitecodeadmittingneonatal,''),
sitecodeintendeddelivery = nullif(@sitecodeintendeddelivery,''),
skintoskincontact1hour = nullif(@skintoskincontact1hour,''),
smokingstatus = nullif(@smokingstatus,''),
startdatetimemotherdeliveryhps = nullif(@startdatetimemotherdeliveryhps,''),
substanceusestatus = nullif(@substanceusestatus,''),
supportstatusmother = nullif(@supportstatusmother,''),
validnhsnoflag = nullif(@validnhsnoflag,''),
validpostcodeflag = nullif(@validpostcodeflag,''),
waterdeliveryind = nullif(@waterdeliveryind,''),
yearofbirthbaby = nullif(@yearofbirthbaby,'')
;

CREATE INDEX recidmum on rekggth_hes_ons.MSDS_1718 (record_id_mother);
CREATE INDEX recidbaby on rekggth_hes_ons.MSDS_1718 (record_id_baby);


-- and the next year
CREATE TABLE rekggth_hes_ons.MSDS_1819 (
record_id_mother			varchar(7),
record_id_baby			varchar(7),
abnormalitydatingultrasound			varchar(3),
ageatbirthmother			smallint,
ageatbookingmother			smallint,
ageatdeathbaby			smallint,
ageatdeathmother			smallint,
alcoholunitsperweek			smallint,
antenatalappactivitydate			varchar(219),
antenatalbookingappdate			varchar(10),
antepathlevel			smallint,
apgarscore5			smallint,
babybreastmilkstatusdischarge			varchar(2),
babycomplicationatbirth			varchar(11),
babyfirstfeed			smallint,
babyfirstfeedbreastmilkstatus			varchar(2),
birthordermaternitysus			varchar(2),
birthweight			smallint,
caesareandatetime			datetime,
careplandate			varchar(54),
careplantype			varchar(14),
ccg_resmother			varchar(3),
cigarettesperday			smallint,
complexsocialfactorsind			varchar(1),
complicatingdiagtypemother			varchar(31),
countymother			varchar(9),
dayofbirthbaby			tinyint,
dayofdeathbaby			tinyint, 
dayssincedeliveryatdeathmother			smallint,
deathindicatormother			tinyint,
decisiontodeliverdatetime			datetime,
deliverymethodbaby			smallint,
deliveryplacechangereasoncode			varchar(9),
dischargedatetimemotherdeliveryh			datetime,
eddagreed			date,
eddlastmenstrualperiod			date,
eddmethodagreed			varchar(2),
electoralwardmother			varchar(9),
employmentstatusmother			varchar(2),
employmentstatuspartner			varchar(2),
eopsmokingstatus			varchar(7),
episiotomyreason			varchar(2),
fetalorderultrasoundanomaly			varchar(3),
firstlanguageenglishindmother			varchar(1),
folicacidsupplement			varchar(2),
genitaltracttraumaticlesion			varchar(14),
gestagefirstcontact			smallint,
gestageformalantenatalbooking			smallint,
gestationdatingultrasound			varchar(7),
gestationlengthbirth			smallint,
hpsantenataldischargedate			varchar(87),
hpsantenatalstartdate			varchar(87),
investigationresultultrasoundfet			varchar(5),
labouranaesthesiatype			varchar(11),
labourinductionmethod			varchar(5),
labouronsetdatetime			datetime,
labouronsetpresentation			varchar(2),
labourpainreliefmethod			varchar(20),
lad_uamother			varchar(9),
lastmenstrualperioddate			date,
leadanteprovider			varchar(3),
leadpostprov			varchar(5),
leadprofessionaltype			varchar(19),
lengthtimefirststagelabour			smallint,
lsoamother2011			varchar(9),
maternitydischargedate			varchar(43),
maternityfamilyhistorydiagtypeat			varchar(31),
mcidatetime			varchar(21),
mcitype			varchar(5),
merofbirthbaby			varchar(2),
mhpredictiondetectionindmother			varchar(1),
monthofbirthbaby			smallint,
neonatalcriticalincidentdate			varchar(54),
neonatalcriticalincidenttype			varchar(14),
neonataldiag			varchar(5),
neonataldiagdate			varchar(21),
neonatalresuscitationmethod			varchar(11),
neonataltransferstartdatetime			varchar(32),
newbornphysicalexamresulteyes			varchar(2),
newbornphysicalexamresultheart			varchar(2),
newbornphysicalexamresulthips			varchar(2),
newbornphysicalexamresulttestes			varchar(2),
newbornphysicalscreeningdate			date,
nhsnumberstatusmother			varchar(2),
nofetusesdatingultrasound			varchar(3),
orgcodeccg_gpp			varchar(3),
orgcodecommissioner			varchar(5),
orgcodegmpmother			varchar(6),
orgcodepostnatalpathleadprovider			varchar(5),
orgcodeprovider			varchar(3),
oxytocinadministereddatetime			varchar(21),
persondeathdatetimebaby			datetime,
persondeathdatetimemother			datetime,
personheight			float(6),
personphenotypicsex			varchar(1),
personweight			float(6),
physicaldisabilitystatusindmothe			varchar(1),
placentadeliverymethod			varchar(2),
placetypeactualdelivery			varchar(1),
placetypeactualmidwifery			varchar(1),
placetypeintendeddelivery			varchar(9),
placetypeintendedmidwifery			varchar(9),
postcodedistrictmother			varchar(4),
postpartumhspdischargedatetime			varchar(43),
postpartumhspstartdatetime			varchar(43),
postpathlevel			varchar(19),
pregnancyfirstcontactcareprofess			varchar(19),
pregnancyfirstcontactdate			varchar(43),
pregnancymedicaldiagdate			varchar(43),
pregnancymedicaldiagtype			varchar(14),
pregnancyobstetricdiagdate			varchar(54),
pregnancyobstetricdiagtype			varchar(14),
pregnancyoutcomemonth			smallint,
pregnancyoutcomeyear			smallint,
previouscaesareansections			smallint,
previouscomplicatingdiagtypemoth			varchar(19),
previouslivebirths			smallint,
previouslosseslessthan24weeks			smallint,
previousstillbirths			smallint,
proceduredatedatingultrasound			varchar(21),
proceduredatetimefetalanomaly			varchar(21),
rank_imd_decile_2015			varchar(19),
romdatetime			datetime,
rommethod			varchar(2),
romreason			varchar(2),
sitecodeactualdelivery			varchar(6),
sitecodeadmittingneonatal			varchar(17),
sitecodeintendeddelivery			varchar(29),
skintoskincontact1hour			varchar(1),
smokingstatus			varchar(2),
startdatetimemotherdeliveryhps			datetime,
substanceusestatus			varchar(2),
supportstatusmother			varchar(1),
validnhsnoflag			varchar(1),
validpostcodeflag			varchar(1),
waterdeliveryind			varchar(1),
yearofbirthbaby			smallint
)
;

LOAD DATA LOCAL INFILE '~path/NIC393510_MSDS_1819_R.txt'
INTO TABLE rekggth_hes_ons.MSDS_1819
fields terminated by "\t"
lines terminated by "\n"
ignore 1 lines
(@record_id_mother, @record_id_baby, @abnormalitydatingultrasound, @ageatbirthmother, @ageatbookingmother, @ageatdeathbaby, @ageatdeathmother, @alcoholunitsperweek, 
@antenatalappactivitydate, @antenatalbookingappdate, @antepathlevel, @apgarscore5, @babybreastmilkstatusdischarge, @babycomplicationatbirth, @babyfirstfeed, 
@babyfirstfeedbreastmilkstatus, @birthordermaternitysus, @birthweight, @caesareandatetime, @careplandate, @careplantype, @ccg_resmother, @cigarettesperday, 
@complexsocialfactorsind, @complicatingdiagtypemother, @countymother, @dayofbirthbaby, @dayofdeathbaby, @dayssincedeliveryatdeathmother, @deathindicatormother, 
@decisiontodeliverdatetime, @deliverymethodbaby, @deliveryplacechangereasoncode, @dischargedatetimemotherdeliveryh, @eddagreed, @eddlastmenstrualperiod, @eddmethodagreed, 
@electoralwardmother, @employmentstatusmother, @employmentstatuspartner, @eopsmokingstatus, @episiotomyreason, @fetalorderultrasoundanomaly, @firstlanguageenglishindmother, 
@folicacidsupplement, @genitaltracttraumaticlesion, @gestagefirstcontact, @gestageformalantenatalbooking, @gestationdatingultrasound, @gestationlengthbirth, 
@hpsantenataldischargedate, @hpsantenatalstartdate, @investigationresultultrasoundfet, @labouranaesthesiatype, @labourinductionmethod, @labouronsetdatetime, 
@labouronsetpresentation, @labourpainreliefmethod, @lad_uamother, @lastmenstrualperioddate, @leadanteprovider, @leadpostprov, @leadprofessionaltype, @lengthtimefirststagelabour, 
@lsoamother2011, @maternitydischargedate, @maternityfamilyhistorydiagtypeat, @mcidatetime, @mcitype, @merofbirthbaby, @mhpredictiondetectionindmother, @monthofbirthbaby, 
@neonatalcriticalincidentdate, @neonatalcriticalincidenttype, @neonataldiag, @neonataldiagdate, @neonatalresuscitationmethod, @neonataltransferstartdatetime, @newbornphysicalexamresulteyes, 
@newbornphysicalexamresultheart, @newbornphysicalexamresulthips, @newbornphysicalexamresulttestes, @newbornphysicalscreeningdate, @nhsnumberstatusmother, @nofetusesdatingultrasound, 
@orgcodeccg_gpp, @orgcodecommissioner, @orgcodegmpmother, @orgcodepostnatalpathleadprovider, @orgcodeprovider, @oxytocinadministereddatetime, @persondeathdatetimebaby, 
@persondeathdatetimemother, @personheight, @personphenotypicsex, @personweight, @physicaldisabilitystatusindmothe, @placentadeliverymethod, @placetypeactualdelivery, 
@placetypeactualmidwifery, @placetypeintendeddelivery, @placetypeintendedmidwifery, @postcodedistrictmother, @postpartumhspdischargedatetime, @postpartumhspstartdatetime, 
@postpathlevel, @pregnancyfirstcontactcareprofess, @pregnancyfirstcontactdate, @pregnancymedicaldiagdate, @pregnancymedicaldiagtype, @pregnancyobstetricdiagdate, @pregnancyobstetricdiagtype, 
@pregnancyoutcomemonth, @pregnancyoutcomeyear, @previouscaesareansections, @previouscomplicatingdiagtypemoth, @previouslivebirths, @previouslosseslessthan24weeks, @previousstillbirths, 
@proceduredatedatingultrasound, @proceduredatetimefetalanomaly, @rank_imd_decile_2015, @romdatetime, @rommethod, @romreason, @sitecodeactualdelivery, @sitecodeadmittingneonatal, 
@sitecodeintendeddelivery, @skintoskincontact1hour, @smokingstatus, @startdatetimemotherdeliveryhps, @substanceusestatus, @supportstatusmother, @validnhsnoflag, @validpostcodeflag, 
@waterdeliveryind, @yearofbirthbaby)
SET
record_id_mother = nullif(@record_id_mother,''),
record_id_baby = nullif(@record_id_baby,''),
abnormalitydatingultrasound = nullif(@abnormalitydatingultrasound,''),
ageatbirthmother = nullif(@ageatbirthmother,''),
ageatbookingmother = nullif(@ageatbookingmother,''),
ageatdeathbaby = nullif(@ageatdeathbaby,''),
ageatdeathmother = nullif(@ageatdeathmother,''),
alcoholunitsperweek = nullif(@alcoholunitsperweek,''),
antenatalappactivitydate = nullif(@antenatalappactivitydate,''),
antenatalbookingappdate = nullif(@antenatalbookingappdate,''),
antepathlevel = nullif(@antepathlevel,''),
apgarscore5 = nullif(@apgarscore5,''),
babybreastmilkstatusdischarge = nullif(@babybreastmilkstatusdischarge,''),
babycomplicationatbirth = nullif(@babycomplicationatbirth,''),
babyfirstfeed = nullif(@babyfirstfeed,''),
babyfirstfeedbreastmilkstatus = nullif(@babyfirstfeedbreastmilkstatus,''),
birthordermaternitysus = nullif(@birthordermaternitysus,''),
birthweight = nullif(@birthweight,''),
caesareandatetime = nullif(@caesareandatetime,''),
careplandate = nullif(@careplandate,''),
careplantype = nullif(@careplantype,''),
ccg_resmother = nullif(@ccg_resmother,''),
cigarettesperday = nullif(@cigarettesperday,''),
complexsocialfactorsind = nullif(@complexsocialfactorsind,''),
complicatingdiagtypemother = nullif(@complicatingdiagtypemother,''),
countymother = nullif(@countymother,''),
dayofbirthbaby = nullif(@dayofbirthbaby,''),
dayofdeathbaby = nullif(@dayofdeathbaby,''),
dayssincedeliveryatdeathmother = nullif(@dayssincedeliveryatdeathmother,''),
deathindicatormother = nullif(@deathindicatormother,''),
decisiontodeliverdatetime = nullif(@decisiontodeliverdatetime,''),
deliverymethodbaby = nullif(@deliverymethodbaby,''),
deliveryplacechangereasoncode = nullif(@deliveryplacechangereasoncode,''),
dischargedatetimemotherdeliveryh = nullif(@dischargedatetimemotherdeliveryh,''),
eddagreed = nullif(@eddagreed,''),
eddlastmenstrualperiod = nullif(@eddlastmenstrualperiod,''),
eddmethodagreed = nullif(@eddmethodagreed,''),
electoralwardmother = nullif(@electoralwardmother,''),
employmentstatusmother = nullif(@employmentstatusmother,''),
employmentstatuspartner = nullif(@employmentstatuspartner,''),
eopsmokingstatus = nullif(@eopsmokingstatus,''),
episiotomyreason = nullif(@episiotomyreason,''),
fetalorderultrasoundanomaly = nullif(@fetalorderultrasoundanomaly,''),
firstlanguageenglishindmother = nullif(@firstlanguageenglishindmother,''),
folicacidsupplement = nullif(@folicacidsupplement,''),
genitaltracttraumaticlesion = nullif(@genitaltracttraumaticlesion,''),
gestagefirstcontact = nullif(@gestagefirstcontact,''),
gestageformalantenatalbooking = nullif(@gestageformalantenatalbooking,''),
gestationdatingultrasound = nullif(@gestationdatingultrasound,''),
gestationlengthbirth = nullif(@gestationlengthbirth,''),
hpsantenataldischargedate = nullif(@hpsantenataldischargedate,''),
hpsantenatalstartdate = nullif(@hpsantenatalstartdate,''),
investigationresultultrasoundfet = nullif(@investigationresultultrasoundfet,''),
labouranaesthesiatype = nullif(@labouranaesthesiatype,''),
labourinductionmethod = nullif(@labourinductionmethod,''),
labouronsetdatetime = nullif(@labouronsetdatetime,''),
labouronsetpresentation = nullif(@labouronsetpresentation,''),
labourpainreliefmethod = nullif(@labourpainreliefmethod,''),
lad_uamother = nullif(@lad_uamother,''),
lastmenstrualperioddate = nullif(@lastmenstrualperioddate,''),
leadanteprovider = nullif(@leadanteprovider,''),
leadpostprov = nullif(@leadpostprov,''),
leadprofessionaltype = nullif(@leadprofessionaltype,''),
lengthtimefirststagelabour = nullif(@lengthtimefirststagelabour,''),
lsoamother2011 = nullif(@lsoamother2011,''),
maternitydischargedate = nullif(@maternitydischargedate,''),
maternityfamilyhistorydiagtypeat = nullif(@maternityfamilyhistorydiagtypeat,''),
mcidatetime = nullif(@mcidatetime,''),
mcitype = nullif(@mcitype,''),
merofbirthbaby = nullif(@merofbirthbaby,''),
mhpredictiondetectionindmother = nullif(@mhpredictiondetectionindmother,''),
monthofbirthbaby = nullif(@monthofbirthbaby,''),
neonatalcriticalincidentdate = nullif(@neonatalcriticalincidentdate,''),
neonatalcriticalincidenttype = nullif(@neonatalcriticalincidenttype,''),
neonataldiag = nullif(@neonataldiag,''),
neonataldiagdate = nullif(@neonataldiagdate,''),
neonatalresuscitationmethod = nullif(@neonatalresuscitationmethod,''),
neonataltransferstartdatetime = nullif(@neonataltransferstartdatetime,''),
newbornphysicalexamresulteyes = nullif(@newbornphysicalexamresulteyes,''),
newbornphysicalexamresultheart = nullif(@newbornphysicalexamresultheart,''),
newbornphysicalexamresulthips = nullif(@newbornphysicalexamresulthips,''),
newbornphysicalexamresulttestes = nullif(@newbornphysicalexamresulttestes,''),
newbornphysicalscreeningdate = nullif(@newbornphysicalscreeningdate,''),
nhsnumberstatusmother = nullif(@nhsnumberstatusmother,''),
nofetusesdatingultrasound = nullif(@nofetusesdatingultrasound,''),
orgcodeccg_gpp = nullif(@orgcodeccg_gpp,''),
orgcodecommissioner = nullif(@orgcodecommissioner,''),
orgcodegmpmother = nullif(@orgcodegmpmother,''),
orgcodepostnatalpathleadprovider = nullif(@orgcodepostnatalpathleadprovider,''),
orgcodeprovider = nullif(@orgcodeprovider,''),
oxytocinadministereddatetime = nullif(@oxytocinadministereddatetime,''),
persondeathdatetimebaby = nullif(@persondeathdatetimebaby,''),
persondeathdatetimemother = nullif(@persondeathdatetimemother,''),
personheight = nullif(@personheight,''),
personphenotypicsex = nullif(@personphenotypicsex,''),
personweight = nullif(@personweight,''),
physicaldisabilitystatusindmothe = nullif(@physicaldisabilitystatusindmothe,''),
placentadeliverymethod = nullif(@placentadeliverymethod,''),
placetypeactualdelivery = nullif(@placetypeactualdelivery,''),
placetypeactualmidwifery = nullif(@placetypeactualmidwifery,''),
placetypeintendeddelivery = nullif(@placetypeintendeddelivery,''),
placetypeintendedmidwifery = nullif(@placetypeintendedmidwifery,''),
postcodedistrictmother = nullif(@postcodedistrictmother,''),
postpartumhspdischargedatetime = nullif(@postpartumhspdischargedatetime,''),
postpartumhspstartdatetime = nullif(@postpartumhspstartdatetime,''),
postpathlevel = nullif(@postpathlevel,''),
pregnancyfirstcontactcareprofess = nullif(@pregnancyfirstcontactcareprofess,''),
pregnancyfirstcontactdate = nullif(@pregnancyfirstcontactdate,''),
pregnancymedicaldiagdate = nullif(@pregnancymedicaldiagdate,''),
pregnancymedicaldiagtype = nullif(@pregnancymedicaldiagtype,''),
pregnancyobstetricdiagdate = nullif(@pregnancyobstetricdiagdate,''),
pregnancyobstetricdiagtype = nullif(@pregnancyobstetricdiagtype,''),
pregnancyoutcomemonth = nullif(@pregnancyoutcomemonth,''),
pregnancyoutcomeyear = nullif(@pregnancyoutcomeyear,''),
previouscaesareansections = nullif(@previouscaesareansections,''),
previouscomplicatingdiagtypemoth = nullif(@previouscomplicatingdiagtypemoth,''),
previouslivebirths = nullif(@previouslivebirths,''),
previouslosseslessthan24weeks = nullif(@previouslosseslessthan24weeks,''),
previousstillbirths = nullif(@previousstillbirths,''),
proceduredatedatingultrasound = nullif(@proceduredatedatingultrasound,''),
proceduredatetimefetalanomaly = nullif(@proceduredatetimefetalanomaly,''),
rank_imd_decile_2015 = nullif(@rank_imd_decile_2015,''),
romdatetime = nullif(@romdatetime,''),
rommethod = nullif(@rommethod,''),
romreason = nullif(@romreason,''),
sitecodeactualdelivery = nullif(@sitecodeactualdelivery,''),
sitecodeadmittingneonatal = nullif(@sitecodeadmittingneonatal,''),
sitecodeintendeddelivery = nullif(@sitecodeintendeddelivery,''),
skintoskincontact1hour = nullif(@skintoskincontact1hour,''),
smokingstatus = nullif(@smokingstatus,''),
startdatetimemotherdeliveryhps = nullif(@startdatetimemotherdeliveryhps,''),
substanceusestatus = nullif(@substanceusestatus,''),
supportstatusmother = nullif(@supportstatusmother,''),
validnhsnoflag = nullif(@validnhsnoflag,''),
validpostcodeflag = nullif(@validpostcodeflag,''),
waterdeliveryind = nullif(@waterdeliveryind,''),
yearofbirthbaby = nullif(@yearofbirthbaby,'')
;

CREATE INDEX recidmum on rekggth_hes_ons.MSDS_1819 (record_id_mother);
CREATE INDEX recidbaby on rekggth_hes_ons.MSDS_1819 (record_id_baby);


-- put all years into one big table

CREATE TABLE rekggth_hes_ons.MSDS_full 
	select * from rekggth_hes_ons.MSDS_1516;
    
INSERT INTO rekggth_hes_ons.MSDS_full 
	select * from rekggth_hes_ons.MSDS_1617;
    
INSERT INTO rekggth_hes_ons.MSDS_full 
	select * from rekggth_hes_ons.MSDS_1718;
    
INSERT INTO rekggth_hes_ons.MSDS_full 
	select * from rekggth_hes_ons.MSDS_1819;
    
update rekggth_hes_ons.MSDS_full 
set 
	yearofbirthbaby = replace(yearofbirthbaby, '\r', '')
;

alter table rekggth_hes_ons.MSDS_full
add column tokenid varchar(15)
;

UPDATE rekggth_hes_ons.MSDS_full as dest, rekggth_hes_ons.MSDS_BF as newdata
SET dest.tokenid = newdata.tokenid
WHERE dest.record_id_mother=newdata.record_id;

ALTER TABLE rekggth_hes_ons.MSDS_full
CHANGE COLUMN `tokenid` `tokenid` VARCHAR(15) NULL DEFAULT NULL FIRST;

CREATE INDEX tpid on rekggth_hes_ons.MSDS_full (tokenid);

DROP TABLE rekggth_hes_ons.MSDS_1819;
DROP TABLE rekggth_hes_ons.MSDS_1718;
DROP TABLE rekggth_hes_ons.MSDS_1617;
DROP TABLE rekggth_hes_ons.MSDS_1516;
DROP TABLE rekggth_hes_ons.MSDS_BF;

    
